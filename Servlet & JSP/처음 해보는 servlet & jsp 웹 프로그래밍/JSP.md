## JSP(JavaServer Pages)

### JSP란?
JSP (JavaServer Pages)는 HTML, DHTML, XHTML, XML과 같은 동적 웹 콘텐츠를 생성하는 애플리케이션을 만들기 위한 J2EE 플랫폼에 속하는 자바 기술입니다. JSP 기술은 동적 콘텐츠를 만들어내는 웹페이지를 쉽고 강력하면서도 유연하게 작성할 수 있도록 해줍니다.

***

### JSP 개념

동적인 콘텐츠를 만들 때는 어떠한 형태로든 "콘텐츠를 어떻게 생성할지"를 지시하는 프로그래밍이 필요합니다. 그런데 서블릿처럼 프로그램 소스 안에 HTTML, 태그를 처리하면, 변경이 일어날 때마다 매번 컴파일해줘야 해서 동적인 콘텐츠를 만들기 어렵습니다. JSP 기술은 동적으로 콘텐츠를 생성하기 위해 프로그래밍 코드가 담긴 스크립트를 포함할 수 있게 하고, HTML과 유사한 태그를 통해 어려운 자바 코딩 없이도 자바 객체를 사용할 수 있게 합니다.
JSP는 1998년 첫 번째 API가 발표되었고 1999년 6월 1.0. 1.1, 1.2 스펙에 이어, 2017년 03월 현재 JSP 2.3으로 J2EE1.7 스펙에 포함되어 있습니다. 이 스펙들은 서블릿과 JSP를 지원하는 웹서버나 웹 애플리케이션 서버에 의해 구현되고 있으며, 이미 구현된 JSTL(Java Standard Tag Library)과 같은 태그 라이브러리도 있고, 동적 데이터 표현을 위한 간단한 EL(Expression Language) 같은 기술들이 개 발 환경을 더욱 풍성하게 해주고 있습니다. 이들은 웹 서비스에서 최전방을 담당하는 기술들로서 웹 서비스 구현에 밑거름이 되고 있습니다.


JSP 기술은 다음과 같은 개념을 기반으로 만들어졌습니다.
#### 템플릿 데이터

대부분 동적 웹 콘텐츠를 이루는 많은 부분은 고정되어 있거나 템플릿(Termplate) 데이터입니다. 템플릿 데이터는 전형적으로 텍스트나 XML, 조각, HTML 태그들일 수 있습니다. JSP 기술은 이러한 템플릿 데이터들이 변형되지 않도록 처리하는 방법을 지원합니다.

```JSP
<HTML>
    <BODY>
        <H1>Hello World!</H1>
    </BODY>
</HTML>
```


JSP에서 이러한 템플릿 데이터 부분은 해석하지 않고 그대로 출력해줍니다. 서블릿은 HTML, 코드 부분을 `out.print("<HTML>”);`와 같이 출력해줘야 하지만, JSP는 프로그램적인 명령문들만 컨테이너가 해석해서 처리하고, HTML 태그 부분은 그대로 HTML로 처리되므로 별도의 명령문들로 처리할 필요가 없습니다.

#### 동적인 데이터의 추가

JSP 기술은 템플릿 데이터에 동적인 데이터를 끼워 넣을 수 있는 간단하지만 강력한 방법을 제공합니다.

```jsp
<HTML>
	<BODY>
        <H1>Hello World!</H1>
		<%= request.getParameter("name") %>
	</BODY>
</HTML>
```


위 코드는 name이라는 질의 문자열을 추출하여 출력하는 코드입니다. JSP에서 제공하는 내장 객체 request를 이용해서 쉽게 동적인 데이터를 추가할 수 있습니다. 이처럼 JSP에서는 템플릿 데이터와 함 께 출력을 쉽게 할 수 있는 '표현식(expression)'이라는 스크립팅 요소를 제공하고 있으며, JSP 2.0은 좀 더 확장된 기능으로 EL(Expression Language)이라는 것도 제공하고 있어서 동적인 콘텐츠를 쉽게 작업할 수 있습니다.

#### 기능의 추상화

추상화는 객체지향 프로그램에서 사용하는 용어로서 세부 구현은 숨기고 기능을 사용할 수 있도록 구현 하는 것을 의미하며, 재사용성을 높이는 기술입니다. ISP 기술은 이런 기능의 추상화를 위해 다음 두 가지 메커니즘을 제공합니다.

* 자바빈즈(JavaBeans) 컴포넌트 아키텍처: 컴포넌트라는 개념은 규격에 맞게 조각들을 만들어 놓고 조각들을 이용해 완성한 하나의 제품을 만들자는 것인데요. 자바에서도 규격에 맞는 조각이 있는데 이것을 자바빈즈(JavaBeans)라고 하며, JSP에서 사용하는 컴포넌트는 JSP 자바빈즈라고 합니다. 자바빈즈를 이용하면 재사용성이 높은 웹 애플리케이션을 개발할 수 있습니다.

* 태그 라이브러리: 자주 사용하는 기능을 매번 구현하는 것이 아니라, JSP 태그로 만들어 사용한다면 한 번의 작성으로 여러 곳에서 사용할 수 있어 재사용성을 높일 수 있습니다.

  

이러한 일반적인 개념들을 기반으로 1.92 기술이 정의되어 있으며. 이러한 사항들에 대한 제상한 교회 웹 개발을 더 강력하고 쉽게 만들어 줄 수 있는 바탕이 될 수 있습니다.

***

### JSP 장점

* Write Once, Run Anywhere properties : 자바의 모토라고 할 수 있는 특징으로 JSP는 플랫폼에 무관하고, JSP 스펙을 지원하는 어떠한 웹 애플리케이션 서버에서도 동작합니다.

* 역할 분리: JSP는 프레젠테이션 기능과 비즈니스 로직 기능을 분리할 수 있어서 개발자와 디자이너의 역할을 분리할 수 있습니다. 

* 컴포넌트와 태그 라이브러리의 재사용: JSP는 자바빈즈 컴포넌트와 EJB, 태그 라이브러리에 기반을 두고 재사용성을 강조하고 있습니다. 이미 재사용할 수 있는 많은 태그 라이브러리가 있으며, 컴포넌트 기반의 페이지를 작성할 수 있는 방법을 제공합니다.
* 정적 콘텐츠와 동적 콘텐츠의 분리
* 액션, 표현식, 스크립팅 제공: 추상화한 표준태그
* N-tier 엔터프라이즈 애플리케이션을 위한 웹 접근 레이어: 여러 레이어로 구분 가능

***

### JSP 실행 순서

![image](https://github.com/siwoo1627/Today-I-Learn/assets/114638386/386fbe8e-2c35-49cd-bbf8-4885b2fe79b8)

1. 클라이언트로부터 JSP요청이 들어오면, JSP 컨테이너는 태그로 만들어진 JSP 파일을 완벽한 자바 소스로 변환하여 *.java파일로 만듬
2. JSP컨테이너는 *.jsp파일을 변환한 *.java 파일을 컴파일하여 *.class 파일을 만듬
3. 컴파일된 자바 실행 파일은 서블릿 컨테이너에 의해 서블릿으러서 동작
4. 변환과 컴파일 작업은 최초의 요청이나 JSP가 변경되었을 때만 수행됨

**변환**: 컨테이너는 JSP를 해석하여 하나의 서블릿 소스로 만든 다음에 해당 소스를 컴파일한다. 그러면 서블릿 클래스 파일이 생성되는데, 이 서블릿 클래스는 JSP가 실행될 수 있는 형태로 구현된 JSP 구현 클래스이다.

**실행**: 컨테이너는 서블릿으로 변환되어 컴파일된 구현 서블릿 클래스를 초기화하고, 이 서블릿 클래스를 통해 요청을 처리하고 응답한다.

***

* 주석`<%-- --%>`

* 지시자`<%@ 지시자 속상 = 값 %>`: JSP 컨테이너가 JSP 페이지를 파싱하여 자바 소스로 변환하는 데 필요한 정보를 알려주기 위해 사용

```jsp
<%@  page  contentType="text/html; charset=UTF-8"  import="java.util.*"  %>
```

* errorPage와 isErrorPage 속성

```jsp
<%@ page contentType="text/html;charset=UTF-8"%>
<%@ page isErrorPage="true"%>
<html>
<head>
<title>예외상황 처리</title>
</head>
<body>
	<h4>다음과 같은 에러가 발생하였습니다.</h4>
	에러타입 :
	<%=exception.getClass().getName()%>
	<br> 에러메세지:
	<%=exception.getMessage()%>
</body>
</html>
```

아래의 jsp 실행 시 param이 빈값이면 오류가 발생하여 위의 페이지에서 오류처리함

```jsp
<%@ page contentType="text/html;charset=UTF-8"%>
<%@ page errorPage="example3.jsp"%>
<%
	String param = request.getParameter("id");
	if (param.equals("test"))
		param = " 파라미터가 입력되었습니다. (예외 상황이 발생하지 않았습니다.)";
%>
<html>
<body>
	<h4>
		<%=param%>
	</h4>
</body>
</html>
```

* trimDirectiveWhitespaces 첫째 줄 빈 줄 제거

```jsp
<%@ page contentType="text/html; charset=UTF-8"%>
<%@ page trimDirectiveWhitespaces="true" %>
```

* include

```jsp
<%@ include file="copyright.jsp" %>
```

* 스크립트릿`<% 실행문 %>`: 자바코드 추가

* 표현식`<%= 실행문 %>`: 변수 표현 (=`out.print(변수)`)

* 선언문`<%! 변수 선언 %>` `<%! 메소드 선언 %>` 

```jsp
<%@ page contentType="text/html; charset=UTF-8"%>
<html>
<head>
<title>덧셈</title>
</head>
<body>
	<h3>선언문으로 구현한 덧셈</h3>
	<%!
		public int sum(int a, int b){
		   return a+b;
    	}
	%>
	덧셈의 결과 : <%= this.sum(20,30) %> 
</body>
</html>
```

***

